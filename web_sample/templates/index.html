<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>音声認識サンプル</title>
  </head>
  <body>
    <h2>音声認識サンプル</h2>
    <button id="btn">start</button>
    <div id="content"></div>

    <script>
      //音声認識の準備
      const speech = new webkitSpeechRecognition();
      speech.lang = "ja-JP";

      //使用する変数を用意
      const btn = document.getElementById("btn");
      const content = document.getElementById("content");

      btn.addEventListener("mousedown", function () {
        // 音声認識をスタート
        speech.start();
      });

      btn.addEventListener("mouseup", function () {
        // 音声認識をストップ
        speech.stop();
      });

      speech.addEventListener("result", function (e) {
        // 音声認識で取得した情報を、コンソール画面に表示
        console.log(e);

        // 音声認識の結果をサーバに送信
        fetch("/voice_recognition", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            result: e.results[0][0].transcript,
          }),
        });
      });
    </script>
  </body>
</html>
